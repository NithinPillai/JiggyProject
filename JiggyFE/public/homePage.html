<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="homePage.css"/>
  <title>Jiggy Dance Project</title>
  <style>
    .modal-error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <a href="#" class="logo">
      <img src="logo.svg" alt="Jiggy Logo"/>
    </a>
    <nav>
      <!-- nav links here -->
    </nav>
  </header>

  <!-- Main Section -->
  <section class="home">
    <div class="home-content">
      <h2 class="typing-text">
        <span id="typed-text"></span><span class="cursor">|</span>
      </h2>
      <p class="subheading">START BY <span>UPLOADING YOUR VIDEO</span></p>

      <!-- Buttons Section -->
      <div class="action-section">
        <div class="btn-icons">
          <a href="#" id="practice-btn"><img src="pencil.png" alt="Pencil Icon"></a>
          <a href="#" id="challenge-btn"><img src="sword.png" alt="Sword Icon"></a>
        </div>
        <a href="#" class="btn" id="uploadBtn">Upload Video File</a>
        <input type="file" id="video-upload" accept="video/*" style="display: none;" />


        <div id="progress-container" class="progress-container" style="display: none;">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill" style="width: 0%;"></div>
          </div>
          <p id="file-name" class="file-name"></p>
        </div>
      </div>
    </div>
  </section>

  <!-- Typing Script -->
  <script>
    const textArray = [
      "Learn to Dance",
      "Dance With Friends",
      "Show Off Your Skills"
    ];
    const typingSpeed = 100,
          erasingSpeed = 60,
          delayBetweenWords = 2000;
    let textIndex = 0, charIndex = 0;
    const typedTextSpan = document.getElementById("typed-text");

    function type() {
      if (charIndex < textArray[textIndex].length) {
        typedTextSpan.textContent += textArray[textIndex].charAt(charIndex);
        charIndex++;
        setTimeout(type, typingSpeed);
      } else {
        setTimeout(erase, delayBetweenWords);
      }
    }

    function erase() {
      if (charIndex > 0) {
        typedTextSpan.textContent = textArray[textIndex].substring(0, charIndex - 1);
        charIndex--;
        setTimeout(erase, erasingSpeed);
      } else {
        textIndex++;
        if (textIndex >= textArray.length) textIndex = 0;
        setTimeout(type, typingSpeed + 300);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (textArray.length) setTimeout(type, 500);
    });
  </script>

  <!-- Modal Container -->
  <div id="hover-modal-wrapper">
    <div id="hover-modal-blur" class="hover-modal-blur"></div>
    <div id="hover-modal" class="hover-modal">
      <div class="hover-modal-content">
        <h2 id="modal-title">Modal Title</h2>
        <p id="modal-description">Modal description text goes here.</p>
        <div class="modal-buttons">
          <a href="#" class="btn" id="practice-continue" style="display: inline-block;">
            Continue to Practice
          </a>
          <a href="#" class="btn" id="challenge-continue" style="display: none;">
            Continue to Challenge
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal & Other JS -->
  <script>
    const modalWrapper = document.getElementById("hover-modal-wrapper"),
          modalTitle = document.getElementById("modal-title"),
          modalDescription = document.getElementById("modal-description"),
          practiceContinue = document.getElementById("practice-continue"),
          challengeContinue = document.getElementById("challenge-continue");
    let hideTimer;

    function showModal(title, description, mode) {
      clearTimeout(hideTimer);
      modalTitle.textContent = title;
      modalDescription.textContent = description;
      modalDescription.classList.remove("modal-error");
      
      if (mode === "practice") {
        practiceContinue.style.display = "inline-block";
        challengeContinue.style.display = "none";
      } else if (mode === "challenge") {
        challengeContinue.style.display = "inline-block";
        practiceContinue.style.display = "none";
      } else if (mode === "challenge-error") {
        challengeContinue.style.display = "none";
        practiceContinue.style.display = "none";
        modalDescription.classList.add("modal-error");
      }
      modalWrapper.classList.add("show");
    }

    function scheduleHideModal() {
      hideTimer = setTimeout(() => {
        modalWrapper.classList.remove("show");
      }, 200);
    }

    const practiceBtn = document.getElementById("practice-btn"),
          challengeBtn = document.getElementById("challenge-btn");

    practiceBtn.addEventListener("mouseover", () => {
      showModal("Practice Mode", "Practice your moves and upload later!", "practice");
    });

    challengeBtn.addEventListener("mouseover", () => {
      // Check if an uploaded video exists
      const videoUrl = sessionStorage.getItem("uploadedVideoUrl");
      if (videoUrl) {
        showModal("Challenge Mode", "Go head-to-head with your friends!", "challenge");
      } else {
        showModal("Challenge Mode", "Please upload a video", "challenge-error");
      }
    });

    practiceBtn.addEventListener("mouseout", scheduleHideModal);
    challengeBtn.addEventListener("mouseout", scheduleHideModal);
    modalWrapper.addEventListener("mouseover", () => clearTimeout(hideTimer));
    modalWrapper.addEventListener("mouseout", scheduleHideModal);

    // Only allow Continue to Challenge if a video is uploaded
    challengeContinue.addEventListener('click', (e) => {
      e.preventDefault();
      const videoUrl = sessionStorage.getItem("uploadedVideoUrl");
      if (!videoUrl) {
        alert("Please upload a video before continuing");
      } else {
        window.location.href = 'https://1025-2605-ad80-20-61fa-e8c8-d36a-17d7-77a6.ngrok-free.app/host.html';
      }
    });
  </script>

  <!-- File Upload Script Using FileReader -->
  <script>
    const uploadBtn = document.getElementById('uploadBtn'),
          fileInput = document.getElementById('video-upload'),
          progressContainer = document.getElementById('progress-container'),
          progressFill = document.getElementById('progress-fill'),
          fileNameText = document.getElementById('file-name');

    // Trigger file input when the Upload button is clicked
    uploadBtn.addEventListener('click', (e) => {
      e.preventDefault();
      fileInput.click();
    });

    fileInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (!file) return;

      // Show uploading status
      fileNameText.textContent = `Uploading: ${file.name}`;
      progressContainer.style.display = 'flex';
      progressFill.style.width = '0%';

      // Create a new FileReader instance
      const reader = new FileReader();

      // When FileReader finishes reading the file
      reader.onload = function(e) {
        const dataURL = e.target.result;
        console.log("File read successfully: ", dataURL);

        sessionStorage.setItem("uploadedVideoUrl", dataURL);
        // Update the progress bar to 100% and change the status to "Uploaded"
        progressFill.style.width = '100%';
        fileNameText.textContent = `Uploaded: ${file.name}`;
        fileNameText.style.color = "green";
      };

      reader.onerror = function(e) {
        fileNameText.textContent = "Error uploading file";
      };

      reader.readAsDataURL(file);

      // Optional: Use a fake progress simulation that stops at 90% so that
      // the real FileReader onload can update the final progress.
      let progress = 0;
      const fakeUpload = setInterval(() => {
        if (progress < 90) {
          progress += Math.random() * 10;
          if (progress > 90) progress = 90;
          progressFill.style.width = `${progress}%`;
        }
      }, 200);
    });
  </script>
/
</body>
</html>



